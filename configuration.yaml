---
# Configure a default setup of Home Assistant (frontend, api, etc)
default_config:

homeassistant:
  latitude: -31.923172
  longitude: 116.082237
  elevation: 149
  unit_system: metric
  currency: AUD
  time_zone: Australia/Perth
  country: AU
  name: !secret name
  external_url: !secret external_url
  internal_url: !secret internal_url
  media_dirs:
    local: /Media

zone:
  name: home
  latitude: -31.923172
  longitude: 116.082237
  radius: 70

# Uncomment this if you are using SSL/TLS, running in Docker container, etc.
http:
  use_x_forwarded_for: true
  trusted_proxies:
    - 192.168.30.1
    - 127.0.0.1
    - 2001:44b8:610b:3f30::1

logger:
  default: warning


config:

recorder:
  purge_keep_days: 5
  db_url: !secret postgresql
  exclude:
    domains:
      - device_tracker
      - updater
      - media_player
    entities:
      - sun.sun
      - binary_sensor.back_passage
      - binary_sensor.family_room
      - binary_sensor.laundry_garage_door
      - binary_sensor.light_media_3
      - binary_sensor.media_room
      - binary_sensor.study
      - binary_sensor.kitchen_display_face_detected
      - sensor.time
      - sensor.time_date
      - automation.hass_heartbeat
      - automation.hass_heartbeat_timer


group: !include groups.yaml
automation: !include_dir_merge_list automations
script: !include scripts.yaml
scene: !include scenes.yaml
timer: !include timer.yaml
shell_command: !include shell_commands.yaml

# Text to speech
tts:
  - platform: google_translate
    cache: true
    # base_url: http://192.168.30.1:8123


frontend:
  themes: !include themes.yaml


discovery:
  ignore:
    - netgear_router

rest_command:
  heartbeat:
    url: !secret heartbeat_url
    method: GET
    timeout: 5

powercalc:

mqtt:
  alarm_control_panel:
  - state_topic: "home/alarm"
    command_topic: "home/alarm/set"
    code_arm_required: false
    code_disarm_required: false
  binary_sensor:
  - state_topic: "home/alarm/zones/0"
    name: "Front Door"
    device_class: door
  - state_topic: "home/alarm/zones/1"
    name: "Media Room"
    device_class: moving
  - state_topic: "home/alarm/zones/2"
    name: "Family Room"
    device_class: moving
  - state_topic: "home/alarm/zones/3"
    name: "Back Passage"
    device_class: moving
  - state_topic: "home/alarm/zones/4"
    name: "Study"
    device_class: moving
  - state_topic: "home/alarm/zones/5"
    name: "Laundry/Garage Door"
    device_class: door
  sensor:
  - state_topic: "home/+/SRFBtoMQTT"
    name: 'RFB Button'
    value_template: '{{value_json.value}}'
    qos: 1
    expire_after: 1
  - state_topic: "tele/tasmota/IR/+/RESULT"
    name: 'IR Button'
    value_template: "{{value_json.IrReceived.Data}}"
    qos: 1
    expire_after: 1
  - state_topic: "tele/tasmota/IR/+/RESULT"
    name: "IR Last"
    value_template: "{{value_json.IrReceived.Data}}"
    qos: 1
  - state_topic: "homeassistant/status"
    name: partner
    expire_after: 65
  switch:
  - state_topic: "homeassistant/status"
    command_topic: "homeassistant/status"
    name: Active
    # payload_on: "{{ states('sensor.local_ip') }}"
    payload_off: "offline"
    value_template: "{{ states('sensor.local_ip') == value}}"
  # cover:
  # # - unique_id: "D8BFC01A3A5F"
  # #   name: "Master Bedroom Rollershutter"
  # #   state_topic: "shellies/shellyswitch25-D8BFC01A3A5F/roller/0"
  # #   command_topic: "shellies/shellyswitch25-D8BFC01A3A5F/roller/0/command"
  # #   position_topic: "shellies/shellyswitch25-D8BFC01A3A5F/roller/0/pos"
  # #   set_position_topic: "shellies/shellyswitch25-D8BFC01A3A5F/roller/0/command/pos"
  # #   payload_available: "true"
  # #   payload_not_available: "false"
  # #   payload_open: "open"
  # #   payload_close: "close"
  # #   payload_stop: "stop"
  # #   state_closed: "close"
  # #   state_stopped: "stop"
  # #   position_open: 100
  # #   position_closed: 0
  # #   qos: 1
  # #   retain: false
  # #   optimistic: false
  # - unique_id: "40F5200467D0"
  #   name: "Jonathans Bedroom Rollershutter"
  #   state_topic: "shellies/shellyswitch25-40F5200467D0/roller/0"
  #   command_topic: "shellies/shellyswitch25-40F5200467D0/roller/0/command"
  #   position_topic: "shellies/shellyswitch25-40F5200467D0/roller/0/pos"
  #   set_position_topic: "shellies/shellyswitch25-40F5200467D0/roller/0/command/pos"
  #   payload_available: "true"
  #   payload_not_available: "false"
  #   payload_open: "open"
  #   payload_close: "close"
  #   payload_stop: "stop"
  #   state_closed: "close"
  #   state_stopped: "stop"
  #   position_open: 100
  #   position_closed: 0
  #   qos: 1
  #   retain: false
  #   optimistic: false
  # - unique_id: "40F520055224"
  #   name: "Davids Bedroom Rollershutter"
  #   state_topic: "shellies/shellyswitch25-40F520055224/roller/0"
  #   command_topic: "shellies/shellyswitch25-40F520055224/roller/0/command"
  #   position_topic: "shellies/shellyswitch25-40F520055224/roller/0/pos"
  #   set_position_topic: "shellies/shellyswitch25-40F520055224/roller/0/command/pos"
  #   payload_available: "true"
  #   payload_not_available: "false"
  #   payload_open: "open"
  #   payload_close: "close"
  #   payload_stop: "stop"
  #   state_closed: "close"
  #   state_stopped: "stop"
  #   position_open: 100
  #   position_closed: 0
  #   qos: 1
  #   retain: false
  #   optimistic: false
  vacuum:
  - name: "Sammy"
    schema: state
    supported_features:
      # - turn_on
      # - turn_off
      - return_home
      - start
      - pause
      - stop
    command_topic: "cmnd/tasmotas/irsend"
    # payload_turn_on: "{\"Protocol\":\"SAMSUNG\",\"Bits\":32,\"Data\":\"0x818100FF\",\"DataLSB\":\"0x818100FF\",\"Repeat\":0}"
    # payload_turn_off: "{\"Protocol\":\"SAMSUNG\",\"Bits\":32,\"Data\":\"0x818100FF\",\"DataLSB\":\"0x818100FF\",\"Repeat\":0}"
    payload_return_to_base: "{\"Protocol\":\"SAMSUNG\",\"Bits\":32,\"Data\":\"0x8181807F\",\"DataLSB\":\"0x818101FE\",\"Repeat\":0}"
    payload_start: "{\"Protocol\":\"SAMSUNG\",\"Bits\":32,\"Data\":\"0x818110EF\",\"DataLSB\":\"0x818108F7\",\"Repeat\":0}"
    payload_pause: "{\"Protocol\":\"SAMSUNG\",\"Bits\":32,\"Data\":\"0x818110EF\",\"DataLSB\":\"0x818108F7\",\"Repeat\":0}"
    payload_stop: "{\"Protocol\":\"SAMSUNG\",\"Bits\":32,\"Data\":\"0x818110EF\",\"DataLSB\":\"0x818108F7\",\"Repeat\":0}"


google_assistant:
  project_id: hass
  service_account: !include hass-870815de073b.json
  report_state: !secret google_report_state
  secure_devices_pin: !secret pin
  expose_by_default: false
  entity_config:
    light.passage_lights:
      expose: true
    light.dining_room_lights:
      expose: true
    light.entry_lights:
      expose: true
    light.alfresco_light_1:
      expose: true
    light.light_alfresco_2:
      expose: true
    light.light_backverandah_1:
      expose: true
    light.light_bedside_1:
      expose: true
    light.light_bedside_2:
      expose: true
    light.lifx_jonathans_bedroom:
      expose: true
    light.lifx_davids_room:
      expose: true
    light.light_christmas_1:
      expose: true
    light.light_familyroom_1:
      expose: true
    light.lifx_familyroom_stand:
      expose: true
    light.light_masterbedroom_1:
      expose: true
    light.light_media_1:
      expose: true
    light.light_media_3:
      expose: true
    light.kitchen_lights:
      expose: true
    light.music_room_light:
      expose: true
    light.lego_light:
      expose: true
      name: 'Lego Light'
    switch.switch_kettle:
      expose: true
    switch.fireplace_fan:
      expose: true
    switch.tv:
      expose: true
    switch.media_centre:
      expose: true
    switch.jonathans_reading_light:
      expose: true
    switch.nancys_electric_blanket:
      expose: true
    switch.water_heater:
      expose: true
      name: 'Hot Water System'
      aliases:
        - 'Water Heater'
        - 'Hot Water'
    switch.jonathans_laptop:
      expose: true
      name: 'Jonathans Laptop'
    switch.davids_laptop:
      expose: true
      name: 'Davids Laptop'
    switch.jonathans_computer:
      expose: true
      name: 'Jonathans Computer'
    switch.davids_computer:
      expose: true
      name: 'Davids Computer'
    switch.hex:
      expose: true
      name: 'Hex'
    switch.ponder:
      expose: true
      name: 'Ponder'
    input_boolean.guest:
      expose: true
      name: 'Guest'
    script.1575974067886:
      expose: true
      name: 'Enough Christmas'
    script.1626880666396:
      expose: true
      name: 'Party Lights'
    script.1626880812487:
      expose: true
      name: 'The Fuzz'
    script.1626882379646:
      expose: true
      name: 'DEFCON4'
    script.20201106233201:
      expose: true
      name: 'Christmas Lights'
    vacuum.sammy:
      expose: true
    cover.dining_room_rollershutter:
      expose: true
    cover.master_bedroom_rollershutter:
      expose: true
    cover.jonathans_bedroom_rollershutter:
      expose: true
    cover.davids_bedroom_rollershutter:
      expose: true
    sensor.ble_temperature_a4c13887d585:
      expose: true
      name: 'Diningroom Temperature'
    sensor.rollershutter_diningroom_ds18b20_temperature:
      expose: true
      name: 'Study Temperature'
    climate.jonathans_thermostat:
      expose: true
    climate.davids_thermostat:
      expose: true
    climate.master_bedroom_ac:
      expose: true
    climate.daikin_ac:
      expose: true
    media_player.beocenter_7700:
      expose: true
      name: "Beocenter 7700"
      aliases:
        - "B and O"
      room: "Family Room"
    media_player.yamaha_receiver_media_room:
      expose: true
      name: "Yamaha"
      aliases:
        - 'Media Center'
      room: "Media Room"
    alarm_control_panel.mqtt_alarm:
      expose: true


# calendar:
#   - platform: caldav
#     url: "https://calendar.google.com/calendar/ical/rd12cc9q5lpepgi9ob36pu5k94%40group.calendar.google.com/public/basic.ics"


notify:
  - platform: html5
    name: Push
    vapid_pub_key:
      !secret vapid_pub
    vapid_prv_key:
      !secret vapid_prv
    vapid_email:
      Adrian.a.Woodley@gmail.com
  - name: family
    platform: group
    services:
      - service: mobile_app_adrians_phone
      - service: mobile_app_nancy_s_phone


scrape:
  - resource: https://my.mundaring.wa.gov.au/BinLocationInfo/Info?parcelNumber=104527&suburb=DARLINGTON
    scan_interval: 21600
    sensor:
      - name: "Recycling Days"
        select: ".form-group"
        index: 1
        value_template: '{{ (strptime(value.split(":")[1].strip(), "%d/%m/%Y").date() - now().date()).days }}'


light: !include lights.yaml


#lifx:
#  light:
#    - broadcast: 192.168.29.51 # Dining-1
#    - broadcast: 192.168.29.52 # Dining-2
#    - broadcast: 192.168.29.53 # Dining-3
#    - broadcast: 192.168.29.54 # Dining-4
#    - broadcast: 192.168.29.55 # Jonathans-1
#    - broadcast: 192.168.29.56 # Study-1
#    - broadcast: 192.168.29.57 # Media Room Light Stand
#    - broadcast: 192.168.29.58 # Master Bedroom
#    - broadcast: 192.168.29.59 # Entrance-1
#    - broadcast: 192.168.29.60 # Davids-1
#    - broadcast: 192.168.29.61 # Music-Room-1
#    - broadcast: 192.168.29.62 # Family-Room-Flood
#    - broadcast: 192.168.29.63 # Family-Room-Stand
#    - broadcast: 192.168.29.66 # Kitchen-1
#    - broadcast: 192.168.29.67 # Kitchen-2
#    - broadcast: 192.168.29.68 # Passage-1
#    - broadcast: 192.168.29.69 # Passage-2


climate:
  - platform: dualmode_generic
    unique_id: climate.jonathans_thermostat
    name: Jonathans Thermostat
    heater: switch.jonathans_heater
    cooler: switch.jonathans_fan
    target_sensor: sensor.jonathans_bedroom_temperature
    target_temp: 21
    min_cycle_duration: '00:05:00'
    initial_hvac_mode: 'off'
  - platform: dualmode_generic
    unique_id: climate.davids_thermostat
    name: Davids Thermostat
    heater: switch.davids_heater
    cooler: switch.davids_fan
    target_sensor: sensor.davids_bedroom_temperature
    target_temp: 21
    min_cycle_duration: '00:05:00'
    initial_hvac_mode: 'off'


template:
  - binary_sensor:
    - name: 'Washing Machine'
      unique_id: binary_sensor.washing_machine
      state: >
        {{ states('sensor.washing_mahine_current')|float(0) > 120 }}
      delay_off:
        minutes: 5
      icon: mdi:washing-machine
  - binary_sensor:
    - name: 'Clothes Dryer'
      unique_id: binary_sensor.clothes_dryer
      state: >
        {{ states('sensor.clothes_dryer_current')|float(0) > 0 }}
      delay_off:
        minutes: 2
      icon: mdi:tumble-dryer
  - binary_sensor:
    - name: 'Dish Washer'
      unique_id: binary_sensor.dish_washer
      state: >
        {{ states('sensor.dish_washer_current')|float(0) > 0 }}
      delay_off:
        minutes: 2
      icon: mdi:dishwasher
  # - binary_sensor:
  #   - name: 'TV'
  #     unique_id: binary_sensor.tv
  #     state: >
  #       {{ states('sensor.media_centre_current')|float(0) > 650 }}
  #     icon: mdi:television
  - binary_sensor:
    - name: 'Water Heater'
      unique_id: binary_sensor.water_heater
      state: >
        {{ states('sensor.water_heater_power')|float(0) > 0 }}
      icon: mdi:water-boiler
  - binary_sensor:
    - name: "Active"
      unique_id: binary_sensor.active
      state: "{{ states('sensor.partner') == states('sensor.local_ip') or is_state('sensor.partner', 'offline') or is_state('sensor.partner', 'unavailable') }}"
  - binary_sensor:
    - name: "Bathroom Light"
      unique_id: binary_sensor.light_bathroom_1
      state: "{{states('sun.sun') == 'below_horizon' and states('sensor.bathroom_shelly_luminosity') > '150'}}"
  - binary_sensor:
    - name: "Bin Day"
      unique_id: binary_sensor.bin_day
      state: >-
        {{
          (
            (
              states('sensor.recycling_days') == '8' or 
              states('sensor.recycling_days') == '1'
            )
            and not(bool(states('input_boolean.bin_out')))
          )
        or
          (
            bool(states('input_boolean.bin_out'))
            and not(
              states('sensor.recycling_days') == '8' or 
              states('sensor.recycling_days') == '1'
            )
          )
        }}
  - binary_sensor:
    - name: "Recycling Day"
      unique_id: binary_sensor.recycling_day
      state:  >-
        {{
          (
            (
              states('sensor.recycling_days') == '1'
            )
            and not(bool(states('input_boolean.recycling_out')))
          )
        or
          (
            bool(states('input_boolean.recycling_out'))
            and not(
              states('sensor.recycling_days') == '1'
            )
          )
        }}
  - binary_sensor:
    - name: 'Open House'
      unique_id: binary_sensor.open_house
      state: >-
        {{
        (states('sensor.indoor_temperature_average') < states('input_number.house_target_temperature') and
        states('sensor.ble_outside_temperature') > states('sensor.indoor_temperature_average'))
        or
        (states('sensor.indoor_temperature_average') > states('input_number.house_target_temperature') and
        states('sensor.ble_outside_temperature') < states('sensor.indoor_temperature_average'))
        }}
  - sensor:
    - name: 'Electricity Total'
      unique_id: sensor.electricity_total
      state: "{{ ((states('sensor.shelly_em3_1_channel_a_power')|float(0) + states('sensor.shelly_em3_1_channel_b_power')|float(0) + states('sensor.shelly_em3_1_channel_c_power')|float(0))|round(2))}}"
      unit_of_measurement: W
  - sensor:
    - name: 'Cost Total'
      unique_id: sensor.electricity_cost_total
      state: "{{ ((states('sensor.shelly_em3_1_channel_a_energy_cost')|float(0) + states('sensor.shelly_em3_1_channel_b_energy_cost')|float(0) + states('sensor.shelly_em3_1_channel_c_energy_cost')|float(0))|round(2))}}"
      unit_of_measurement: AUD
  - sensor:
    - name: 'Energy Sum'
      unique_id: sensor.energy_sum
      state: "{{ (states('sensor.shelly_em3_1_channel_a_energy')|float(0) + states('sensor.shelly_em3_1_channel_b_energy')|float(0) + states('sensor.shelly_em3_1_channel_c_energy')|float(0))|round(2)}}"
      unit_of_measurement: kWh
  - sensor:
    - name: 'Energy Cost per Hour'
      unique_id: sensor.energy_cost_per_hour
      state: "{{ (states('sensor.electricity_total')|float(0) / 1000 * 0.266612) | round(2) }}"
      unit_of_measurement: AUD
  - sensor:
    - name: 'Unaccounted Power'
      unique_id: sensor.unaccounted_power
      state: >-
        {% set total = (states('sensor.electricity_total')|float(0)) %}
        {%  set accounted = (
            states('sensor.clothes_dryer_power')|float(0) +
            states('sensor.david_s_bedroom_rollershutter_power')|float(0) + 
            states('sensor.dish_washer_power')|float(0) + 
            states('sensor.fridge_power')|float(0) + 
            states('sensor.jonathan_s_bedroom_rollershutt_power')|float(0) + 
            states('sensor.master_bedroom_air_conditioner_power')|float(0) + 
            states('sensor.master_bedroom_rollershutter_power')|float(0) + 
            states('sensor.media_centre_power')|float(0) + 
            states('sensor.monitors_current_consumption')|float(0) +
            states('sensor.pc_power')|float(0) +
            states('sensor.radios_current_consumption')|float(0) +
            states('sensor.servers_power')|float(0) +
            states('sensor.washing_machine_power')|float(0) +
            states('sensor.davids_heater_power')|float(0) +
            states('sensor.jonathans_heater_power')|float(0) +
            states('sensor.nancys_blanket_power')|float(0) +
            states('sensor.fireplace_fan_power')|float(0) +
            states('sensor.water_heater_power')|float(0)
            ) %}
        {%  set unaccounted = (total - accounted)|round(2) %}
        {%  if unaccounted <= 0 %}
            0
        {%  else %}
            {{ unaccounted }}
        {%  endif %}
      unit_of_measurement: W
  - sensor:
    - name: 'Oven'
      unique_id: sensor.oven
      state: >-
        {% set current = states('sensor.shelly_em3_1_channel_a_current')|float(0) %}
        {% if current > 9 and current < 11 %}
          Heating
        {% elif current > 0.2 and current < 0.3 %}
          At Temperature
        {% else %}
          off
        {% endif %}


switch:
  - platform: template
    switches:
      tv:
        friendly_name: 'TV'
        unique_id: switch.tv
        value_template: "{{ states('sensor.media_centre_current')|float(0) > 200 }}"
        turn_on:
          service: button.press
          target:
            entity_id: button.panasonic_tv_power
        turn_off:
          service: button.press
          target:
            entity_id: button.panasonic_tv_power
  - platform: wake_on_lan
    mac: 6c:0b:84:e2:f6:19
    name: Jonathans Computer
    host: conina
    turn_off:
      service: shell_command.turn_off_jonathans_computer
  - platform: wake_on_lan
    mac: FC:4D:D4:3F:7C:FB
    name: Davids Computer
    host: nijel
    turn_off:
      service: shell_command.turn_off_davids_computer
  - platform: wake_on_lan
    mac: 6C:0B:84:E2:8C:42
    name: Hex
    host: Hex
    turn_off:
      service: shell_command.suspend_hex
  - platform: wake_on_lan
    mac: c8:d3:ff:a6:7a:f2
    name: Ponder
    host: Ponder
    turn_off:
      service: shell_command.suspend_ponder


utility_meter:
  energy_total:
    unique_id: sensor.energy_total
    source: sensor.energy_sum
    cycle: daily
  energy_cost:
    unique_id: sensor.energy_cost
    source: sensor.cost_total
    cycle: daily


sensor:
  - platform: time_date
    display_options:
    - 'time'
    - 'date'
    - 'time_date'
  - platform: min_max
    name: 'Average Indoor Temperature'
    type: mean
    entity_ids:
      - sensor.rollershutter_diningroom_ds18b20_temperature
      - sensor.jonathans_bedroom_temperature
      - sensor.davids_bedroom_temperature
      - sensor.temperature_fe01191a0ae4e128 # Family Room
      - sensor.temperature_843c01d60760f228 # Media Room
      - sensor.ble_temperature_a4c138dfcf8d # Dining Room
      - sensor.ble_temperature_a4c13887d585 # Music Room
      - sensor.ble_temperature_a4c1387f98b8 # Sewing Room
  - platform: integration
    source: sensor.fridge_power
    name: 'Fridge'
    # unit_prefix: k
    round: 2
  - platform: integration
    source: sensor.washing_machine_power
    name: 'Washing Machine'
    # unit_prefix: k
    round: 2
  - platform: integration
    source: sensor.pc_power
    name: 'PC'
    # unit_prefix: k
    round: 2
  - platform: integration
    source: sensor.dish_washer_power
    name: 'Dish Washer'
    # unit_prefix: k
    round: 2
  - platform: integration
    source: sensor.clothes_dryer_power
    name: 'Clothes Dryer'
    # unit_prefix: k
    round: 2
  - platform: integration
    source: sensor.master_bedroom_air_conditioner_power
    name: 'Master Bedroom Air-Conditioner'
    # unit_prefix: k
    round: 2
  - platform: integration
    source: sensor.media_centre_power
    name: 'Media Centre'
    # unit_prefix: k
    round: 2
  - platform: integration
    source: sensor.servers_power
    name: 'Servers'
    # unit_prefix: k
    round: 2
  - platform: integration
    source: sensor.davids_heater_power
    name: 'Davids Heater'
    # unit_prefix: k
    round: 2
  - platform: integration
    source: sensor.jonathans_heater_power
    name: 'Jonathans Heater'
    # unit_prefix: k
    round: 2
  - platform: integration
    source: sensor.nancys_blanket_power
    name: 'Nancys Blanket'
    # unit_prefix: k
    round: 2
  - platform: integration
    source: sensor.fireplace_fan_power
    name: 'Fireplace Fan'
    # unit_prefix: k
    round: 2                
  - platform: integration
    source: sensor.unaccounted_power
    name: 'Unaccounted'
    # unit_prefix: k
    round: 2

media_player:
  # - platform: mpd
  #   host: 192.168.30.38
  #   name: Imp
  - platform: yamaha # takes too long to restart if yamaha off
    name: Yamaha Receiver
    # host: yamaha-proxy
    host: 192.168.30.32
    zone_names:
      Main_Zone: "Media Room"
    source_ignore:
      - "AUX"
      - "Radio"
      - "AV1"
      - "AV2"
      - "AV3"
      - "AV4"
      - "AV5"
      - "AV6"
      - "TUNER"
      - "NET RADIO"
      - "USB"
      - "V-AUX"
      - "iPod (USB)"
    source_names:
      HDMI1: "Blu-Ray"
      HDMI2: "ChromeCast"
      HDMI3: "Volumio"
      HDMI4: "XBox"
  - platform: universal
    name: Beocenter 7700
    children:
      - media_player.family_room
      - media_player.lias
    device_class: receiver
    unique_id: media_player.beocenter_7700
    commands:
      turn_on:
        service: script.beocenter_on
      turn_off:
        service: script.beocenter_off
      volume_up:
        service: button.press
        target:
          entity_id: button.beocenter_volume_up
      volume_down:
        service: button.press
        target:
          entity_id: button.beocenter_volume_down
      volume_mute:
        service: button.press
        target:
          entity_id: button.beocenter_mute
      volume_set:
        service: number.set_value
        target:
          entity_id: number.beocenter_volume
        data:
          value: "{{ volume_level }}"
    attributes:
      volume_level: number.beocenter_volume
      state: binary_sensor.beocenter_power
