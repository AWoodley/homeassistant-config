- id: '1576512904840'
  alias: Lights:Dusk:Sunset
  description: ''
  trigger:
  - event: sunset
    offset: -01:30:00
    platform: sun
  condition: []
  action:
  - entity_id: light.light_entry_2
    service: light.turn_on
  - entity_id: light.light_entry_1,light.light_entry_3
    service: light.turn_off
  - service: script.turn_on
    entity_id: script.1576603594014
    data: {}
  - delay: 00:45:00
  - entity_id: cover.dining_room_rollershutter
    service: cover.close_cover
  mode: single
- id: '1580492573046'
  alias: Switch:Adrian's Phone Charger:Turn On
  description: ''
  trigger:
  - platform: time
    at: 06:00:00
  - platform: numeric_state
    entity_id: sensor.nokia_5_3_battery_level
    below: '35'
  - platform: state
    entity_id: switch.adrian_s_phone_charger
    to: 'on'
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  action:
  - service: switch.turn_on
    entity_id: switch.adrian_s_phone_charger
  - wait_for_trigger:
    - platform: numeric_state
      entity_id: sensor.nokia_5_3_battery_level
      above: '95'
  - service: switch.turn_off
    entity_id: switch.adrian_s_phone_charger
  mode: restart
  max_exceeded: silent
- id: '1580492902537'
  alias: Switch:Nancy's Phone Charger:Turn On
  description: ''
  trigger:
  - platform: time
    at: 03:30:00
  - platform: numeric_state
    entity_id: sensor.nancys_phone_battery_level
    below: '35'
  - platform: state
    entity_id: switch.nancy_s_phone_charger
    to: 'on'
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  action:
  - entity_id: switch.nancy_s_phone_charger
    service: switch.turn_on
  - wait_for_trigger:
    - platform: numeric_state
      entity_id: sensor.nancys_phone_battery_level
      above: '85'
  - service: switch.turn_off
    entity_id: switch.nancy_s_phone_charger
  mode: single
  max_exceeded: silent
- id: '1581009244170'
  alias: Lights:Night:Time
  description: ''
  trigger:
  - at: '20:30:00'
    platform: time
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  action:
  - entity_id: light.light_entry_3
    service: light.turn_on
  - entity_id: light.light_entry_4
    service: light.turn_off
  mode: single
- id: '1581407669990'
  alias: Phantom:Adrian
  description: ''
  trigger:
  - entity_id: person.adrian
    platform: state
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  action:
  - service: mqtt.publish
    data:
      payload_template: '{{ states(''person.adrian'')}}'
      topic: homeassistant/person/adrian
- id: '1582300595341'
  alias: Rollershutter:Dining:Morning:Open
  description: ''
  trigger:
  - event: sunrise
    platform: sun
    offset: 00:45:00
  condition:
    - condition: numeric_state
      entity_id: sensor.ble_temperature_a4c138b45222
      above: 22
    - condition: numeric_state
      entity_id: sensor.darlington_rain_chance_0
      below: 50
  action:
  - entity_id: cover.dining_room_rollershutter
    service: cover.open_cover
  mode: single
- id: '1582300676427'
  alias: Rollershutter:Dining:Afternoon:Open
  description: ''
  trigger:
  - at: '13:00:00'
    platform: time
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  - condition: numeric_state
    entity_id: sensor.ble_temperature_a4c138b45222
    above: '22'
  - condition: numeric_state
    entity_id: sensor.darlington_rain_chance_0
    below: '50'
  - condition: numeric_state
    entity_id: sensor.ble_temperature_a4c138dfcf8d
    below: '24'
  action:
  - entity_id: cover.dining_room_rollershutter
    service: cover.open_cover
  mode: single
# - id: '1584459956003'
#   alias: Switch:Kettle:Started
#   description: ''
#   trigger:
#   - entity_id: switch.switch_arlec_1
#     for: 00:00:15
#     platform: state
#     to: 'on'
#   condition:
#   - condition: state
#     entity_id: binary_sensor.active
#     state: 'on'
#   - condition: state
#     entity_id: sensor.switch_arlec_1_energy_current
#     state: '0.0'
#   action:
#   - service: notify.mobile_app_adrian_s_phone
#     data:
#       message: The kettle has not started.
#       title: Kettle
#   mode: single
# - id: '1584460382480'
#   alias: Switch:Kettle:Finished
#   description: ''
#   trigger:
#   - below: 200
#     entity_id: sensor.switch_kettle_1_energy_voltage
#     platform: numeric_state
#   condition:
#   - condition: state
#     entity_id: binary_sensor.active
#     state: 'on'
#   - condition: device
#     device_id: 24270fe8bcce46d7a35d5929c4f467f0
#     domain: switch
#     entity_id: switch.switch_kettle_1
#     for:
#       hours: 0
#       minutes: 0
#       seconds: 10
#     type: is_on
#   action:
#   - service: notify.mobile_app_adrian_s_phone
#     data:
#       message: The kettle has boiled.
#       title: Kettle
#   - delay: 00:01:00
#   - condition: state
#     entity_id: binary_sensor.switch_kettle_1_button1
#     state: 'on'
#   - service: notify.mobile_app_adrian_s_phone
#     data:
#       message: The kettle has not been reset
#       title: Kettle
#   - device_id: 24270fe8bcce46d7a35d5929c4f467f0
#     domain: switch
#     entity_id: switch.switch_kettle_1
#     type: turn_off
#   mode: single
- id: '1611678447095'
  alias: Rollershutter:Jonathans Bedroom:Open:Time
  description: Open the Jonathans Bedroom Roller shutter at 07:30
  trigger:
  - platform: time
    at: 07:30:00
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  - condition: state
    entity_id: group.family
    state: home
  - condition: time
    weekday:
    - mon
    - tue
    - wed
    - thu
    - fri
    - sat
  - condition: numeric_state
    entity_id: sensor.ble_temperature_a4c138b45222
    above: '20'
  action:
  - service: cover.set_cover_position
    data:
      position: 100
    target:
      entity_id: cover.boys_bedroom_rollershutter
  mode: single
- id: '1611763659185'
  alias: Rollershutter:Master Bedroom:Open:Time
  description: ''
  trigger:
  - platform: time
    at: 07:30:00
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  - condition: state
    entity_id: group.family
    state: home
  - condition: time
    weekday:
    - mon
    - tue
    - wed
    - thu
    - fri
    - sat
  - condition: numeric_state
    entity_id: sensor.ble_temperature_a4c138fbfa2a
    above: '22'
  action:
  - service: cover.open_cover
    data: {}
    entity_id: cover.master_bedroom_rollershutter
  mode: single
- id: '1613410356423'
  alias: Rollershutters:Close:Sunrise
  description: ''
  trigger:
  - platform: sun
    event: sunrise
    offset: -00:45:00
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  action:
  - service: cover.close_cover
    data: {}
    entity_id: cover.master_bedroom_rollershutter, cover.boys_bedroom_rollershutter
  mode: single
- id: '1620144351328'
  alias: Switch:Nancys Electric Blanket
  description: ''
  trigger:
  - platform: state
    entity_id: person.nancy
    to: Home
  - platform: time
    at: '21:01:00'
    id: time
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  - condition: time
    after: '21:01:00'
  - condition: numeric_state
    entity_id: sensor.ble_temperature_a4c138fbfa2a
    below: '21'
  - condition: state
    entity_id: person.nancy
    state: Home
  action:
  - service: switch.turn_on
    target:
      entity_id: switch.nancys_electric_blanket
  - delay:
      hours: 1
      minutes: 0
      seconds: 0
      milliseconds: 0
  - service: switch.turn_off
    target:
      entity_id: switch.nancys_electric_blanket
  mode: restart
- id: '1620211204748'
  alias: Climate:Boys Bedrooms:Warm
  description: ''
  trigger:
  - platform: time
    at: '20:00:00'
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  - condition: state
    entity_id: group.family
    state: home
  - condition: numeric_state
    entity_id: sensor.ble_temperature_a4c138b45222
    below: '20'
  action:
  - service: climate.set_hvac_mode
    data:
      hvac_mode: heat
    target:
      entity_id:
      - climate.davids_thermostat
      - climate.jonathans_thermostat
  mode: single
- id: '1620211304299'
  alias: Turn off Boy's Bedroom Heaters / Fans
  description: ''
  trigger:
  - platform: time
    at: 08:00:00
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  action:
  - service: climate.set_hvac_mode
    data:
      hvac_mode: 'off'
    target:
      entity_id:
      - climate.davids_thermostat
      - climate.jonathans_thermostat
  mode: single
- id: '1620375343556'
  alias: Rollershutter:Dining:Afternoon:Close
  description: ''
  trigger:
  - platform: time
    at: '13:00:00'
  - platform: sun
    event: sunset
    offset: -00:45:00
  condition:
  - condition: numeric_state
    entity_id: sensor.ble_temperature_a4c138b45222
    below: '22'
  - condition: or
    conditions:
    - condition: numeric_state
      entity_id: sensor.darlington_rain_chance_0
      above: '50'
    - condition: numeric_state
      entity_id: sensor.ble_temperature_a4c138dfcf8d
      above: '24'
    - condition: sun
      before: sunset
      before_offset: 00:45:00
  action:
  - service: cover.close_cover
    target:
      entity_id: cover.dining_room_rollershutter
  mode: single
- id: '1620376925668'
  alias: Light:DiningRoom:Off:Rollershutters:Open
  description: ''
  trigger:
  - platform: state
    entity_id: cover.dining_room_rollershutter
    to: open
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  - condition: state
    entity_id: input_boolean.hot_water_system
    state: 'on'
  action:
  - service: light.turn_off
    target:
      entity_id:
      - light.dining_room_lights
      - light.family_room_lights
      - light.music_room_light
    data:
      transition: 30
  mode: single
- id: '1620377026335'
  alias: Light:DiningRoom:On:Rollershutters:Close
  description: ''
  trigger:
  - platform: state
    entity_id: cover.dining_room_rollershutter
    to: closed
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  - condition: state
    entity_id: group.family
    state: home
  action:
  - service: light.turn_on
    data:
      transition: 30
      color_temp: 280
      brightness: 100
  mode: single
- id: '1630777198910'
  alias: Switch:Jonathans Heater:Off
  description: Turn off Jonathan's Heater in the morning
  trigger:
  - platform: time
    at: 08:30
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  action:
  - service: climate.turn_off
    target:
      entity_id: climate.jonathans_thermostat
  mode: single
- id: '1630909236404'
  alias: Lights:Toggle Study Lights:Button
  description: ''
  trigger:
  - platform: event
    event_type: esphome.rf_code_received
    event_data:
      code: '9763476'
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  action:
  - choose:
    - conditions:
      - condition: state
        entity_id: input_select.study_scene
        state: scene.scene_study_bright
      sequence:
      - scene: scene.scene_study_normal
    default:
    - scene: scene.scene_study_bright
  mode: single
- id: '1636125125123'
  alias: Media:Boys-Speakers:Time
  description: Turn off the boy's speakers at midnight
  trigger:
  - platform: time
    at: 00:00
  action:
  - service: media_player.media_stop
    target:
      device_id:
      - fc5fc2c32960cd0c6d56f4ff0122a050
      - 5d1c01a08144d81793bda01ab075cae6
  mode: single
- id: '1654222877842'
  alias: TTS:Water-Heater:Sensor
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.water_heating
    to: 'off'
  condition:
  - condition: time
    before: '15:00:00'
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  action:
  - service: tts.google_translate_say
    data:
      entity_id: media_player.kitchen_speaker, media_player.dining_room_display
      message: The water is hot
  mode: single
- id: '1656167131814'
  alias: Switch:Test
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_boolean.test
    from: 'off'
    id: 'On'
  - platform: state
    entity_id:
    - input_boolean.test
    to: 'off'
    id: 'Off'
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  action:
  - choose:
    - conditions:
      - condition: trigger
        id: 'On'
      sequence:
      - service: scene.create
        data:
          snapshot_entities: input_boolean.test
          scene_id: test_scene
      - service: input_boolean.turn_off
        data: {}
        target:
          entity_id: input_boolean.test
      - service: input_boolean.turn_on
        data: {}
        target:
          entity_id: input_boolean.test_switch
      - delay:
          hours: 0
          minutes: 0
          seconds: 5
          milliseconds: 0
      - service: scene.turn_on
        data: {}
        target:
          entity_id: scene.test_scene
    default:
    - delay:
        hours: 0
        minutes: 0
        seconds: 10
        milliseconds: 0
    - service: input_boolean.turn_off
      data: {}
      target:
        entity_id: input_boolean.test_switch
  mode: single
  max_exceeded: silent
- id: '1658155227206'
  alias: Low-Battery-Alarm
  description: ''
  use_blueprint:
    path: sbyx/low-battery-level-detection-notification-for-all-battery-sensors.yaml
    input:
      exclude:
        entity_id:
        - sensor.nokia_5_3_battery_level
        - sensor.david_s_phone_battery_level
        - sensor.jonathan_s_phone_battery_level
        - sensor.nancys_phone_battery_level
      actions:
      - service: notify.mobile_app_adrian_s_phone
        data:
          title: 'Low Battery '
          message: '{{sensors}}'
- id: '1658506699917'
  alias: Thermostat:Master Bedroom:Time
  description: ''
  trigger:
  - platform: time
    at: '19:30:00'
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  - condition: state
    entity_id: group.family
    state: home
  - condition: numeric_state
    entity_id: sensor.temperature_843c01d60760f228
    below: '19'
  action:
  - service: climate.set_hvac_mode
    data:
      hvac_mode: heat
    target:
      device_id: 28c2ff856d68a09f870340d41b42ea48
  - delay:
      hours: 0
      minutes: 0
      seconds: 30
      milliseconds: 0
  - service: climate.set_temperature
    data:
      temperature: 24
    target:
      device_id: 28c2ff856d68a09f870340d41b42ea48
  - wait_for_trigger:
    - platform: time
      at: '20:30:00'
  - service: climate.set_temperature
    data:
      temperature: 19
    target:
      device_id: 28c2ff856d68a09f870340d41b42ea48
  mode: single
- id: '1660579474503'
  alias: Media:Volume:Volumio
  description: ''
  trigger:
  - platform: state
    entity_id:
    - media_player.yamaha_receiver_media_room
    attribute: source
    to: Volumio
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  - condition: numeric_state
    entity_id: media_player.yamaha_receiver_media_room
    attribute: volume_level
    above: '0.6'
  action:
  - service: media_player.volume_set
    data:
      volume_level: 0.6
    target:
      entity_id: media_player.yamaha_receiver_media_room
  mode: single
- id: '1661337897543'
  alias: Light/Cover:Jonathan:Morning
  description: ''
  use_blueprint:
    path: light-morning.yaml
    input:
      light_id: light.lifx_jonathans_bedroom
      cover_id: cover.jonathans_bedroom_rollershutter
      temperature_sensor_id: sensor.ble_outside_temperature
      person_id: person.jonathan
      schedule_id: schedule.roller_shutter_open
- id: '1661337951517'
  alias: Light/Cover:David:Morning
  description: ''
  use_blueprint:
    path: light-morning.yaml
    input:
      light_id: light.lifx_davids_room
      cover_id: cover.davids_bedroom_rollershutter
      temperature_sensor_id: sensor.ble_outside_temperature
      person_id: person.david
      schedule_id: schedule.roller_shutter_open
- id: '1661338159225'
  alias: Light/Cover:Master Bedroom:Morning
  description: ''
  use_blueprint:
    path: light-morning.yaml
    input:
      light_id: light.light_masterbedroom_1
      cover_id: cover.master_bedroom_rollershutter
      temperature_sensor_id: sensor.ble_outside_temperature
      person_id: person.adrian
      schedule_id: schedule.roller_shutter_open
- id: '1667828983561'
  alias: Switch:Media&TV:Yamaha
  description: Turn on the Media Centre power switch and TV if the Yamaha is switch
    to Chromecast or Blu-Ray
  trigger:
  - platform: state
    entity_id:
    - media_player.yamaha_receiver_media_room
    attribute: source
    to: ChromeCast
  - platform: state
    entity_id:
    - media_player.yamaha_receiver_media_room
    attribute: source
    to: Blu-Ray
  - platform: state
    entity_id:
    - media_player.yamaha_receiver_media_room
    attribute: source
    to: XBox
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  action:
  - service: switch.turn_on
    data: {}
    target:
      entity_id: switch.media_centre
  - delay:
      hours: 0
      minutes: 0
      seconds: 5
      milliseconds: 0
  - service: switch.turn_on
    data: {}
    target:
      entity_id: switch.tv
  mode: single
- id: '1671383260632'
  alias: Masterbedroom-Rollershutter:Close:Sunrise
  description: ''
  use_blueprint:
    path: rollershutter-sunrise.yaml
    input:
      cover_id: cover.master_bedroom_rollershutter_2
- id: '1671383308349'
  alias: Davids-Rollershutter:Close:Sunrise
  description: ''
  use_blueprint:
    path: rollershutter-sunrise.yaml
    input:
      cover_id: cover.davids_bedroom_rollershutter
- id: '1671383334492'
  alias: Jonathans-Rollershutter:Close:Sunrise
  description: ''
  use_blueprint:
    path: rollershutter-sunrise.yaml
    input:
      cover_id: cover.jonathans_bedroom_rollershutter
- id: '1671643125291'
  alias: Beocenter:Turn Off:Idle
  description: Turn off the Beocenter when the media player is idle for 5 minutes.
  trigger:
  - platform: state
    entity_id:
    - media_player.beocenter_7700
    to: idle
    for:
      hours: 0
      minutes: 5
      seconds: 0
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  action:
  - service: media_player.turn_off
    data: {}
    target:
      entity_id: media_player.beocenter_7700
  mode: single
- id: '1671782593308'
  alias: Dinningroom-Display:Pause:Lias
  description: ''
  trigger:
  - platform: state
    entity_id:
    - media_player.lias
    from: idle
  condition:
  - condition: state
    entity_id: switch.active
    state: 'True'
  action:
  - service: media_player.media_pause
    data: {}
    target:
      device_id: 8f3ebf674da343f89b4d135432bf52f0
  mode: single
- id: '1672664235994'
  alias: Beocenter:Turn-On:Lias Playing
  description: Turn off the Beocenter when the media player is idle for 5 minutes.
  trigger:
  - platform: state
    entity_id:
    - media_player.lias
    for:
      hours: 0
      minutes: 0
      seconds: 0
    to: playing
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  action:
  - service: media_player.turn_on
    data: {}
    target:
      entity_id: media_player.beocenter_7700
  mode: single
- id: '1673271059602'
  alias: Oven:TTS:At Temperature
  description: ''
  trigger:
  - platform: state
    entity_id:
    - sensor.oven
    to: At Temperature
  - platform: state
    entity_id:
    - sensor.oven
    to: at_temperature
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  action:
  - service: tts.google_translate_say
    data:
      entity_id: media_player.kitchen_speaker
      message: The oven is warm.
  - wait_for_trigger:
    - platform: state
      entity_id:
      - sensor.oven
      to: 'Off'
    timeout:
      hours: 3
      minutes: 0
      seconds: 0
      milliseconds: 0
  mode: single
- id: '1675437422682'
  alias: Cover:Midnight:Close to 20%
  description: Close the bedroom roller shutters to 20% at Midnight if they're still
    open
  trigger:
  - platform: time
    at: '23:30:00'
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  action:
  - if:
    - condition: numeric_state
      entity_id: cover.master_bedroom_rollershutter
      attribute: current_position
      above: 20
    then:
    - service: cover.set_cover_position
      data:
        position: 20
      target:
        device_id: bb0e513dc9863cc93d9d2adf84bdeac7
  - if:
    - condition: numeric_state
      entity_id: cover.davids_bedroom_rollershutter
      attribute: current_position
      above: 20
    then:
    - service: cover.set_cover_position
      data:
        position: 17
      target:
        device_id: 2d5c4db90acaec27809fc493544258ab
  - if:
    - condition: numeric_state
      entity_id: cover.jonathans_bedroom_rollershutter
      attribute: current_position
      above: 20
    then:
    - service: cover.set_cover_position
      data:
        position: 17
      target:
        device_id: feea1151d882acf2ed0fe9ecf078df26
  mode: single
