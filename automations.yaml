- id: '1576512904840'
  alias: Lights:Dusk:Sunset
  description: ''
  trigger:
  - event: sunset
    offset: -01:30:00
    platform: sun
  condition: []
  action:
  - entity_id: light.light_entry_2
    service: light.turn_on
  - entity_id: light.light_entry_1,light.light_entry_3
    service: light.turn_off
  - service: script.turn_on
    entity_id: script.1576603594014
    data: {}
  - delay: 00:45:00
  - entity_id: cover.dining_room_rollershutter
    service: cover.close_cover
  mode: single
- id: '1580492573046'
  alias: Switch:Adrian's Phone Charger:Turn On
  description: ''
  trigger:
  - platform: time
    at: 06:00:00
  - platform: numeric_state
    entity_id: sensor.nokia_5_3_battery_level
    below: '35'
  - platform: state
    entity_id: switch.adrian_s_phone_charger
    to: 'on'
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  action:
  - service: switch.turn_on
    entity_id: switch.adrian_s_phone_charger
  - wait_for_trigger:
    - platform: numeric_state
      entity_id: sensor.nokia_5_3_battery_level
      above: '95'
  - service: switch.turn_off
    entity_id: switch.adrian_s_phone_charger
  mode: restart
  max_exceeded: silent
- id: '1580492902537'
  alias: Switch:Nancy's Phone Charger:Turn On
  description: ''
  trigger:
  - platform: time
    at: 03:30:00
  - platform: numeric_state
    entity_id: sensor.nancys_phone_battery_level
    below: '35'
  - platform: state
    entity_id: switch.nancy_s_phone_charger
    to: 'on'
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  action:
  - entity_id: switch.nancy_s_phone_charger
    service: switch.turn_on
  - wait_for_trigger:
    - platform: numeric_state
      entity_id: sensor.nancys_phone_battery_level
      above: '85'
  - service: switch.turn_off
    entity_id: switch.nancy_s_phone_charger
  mode: single
  max_exceeded: silent
- id: '1581009244170'
  alias: Lights:Night:Time
  description: ''
  trigger:
  - at: '20:30:00'
    platform: time
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  action:
  - entity_id: light.light_entry_3
    service: light.turn_on
  - entity_id: light.light_entry_4
    service: light.turn_off
  mode: single
- id: '1581407669990'
  alias: Phantom:Adrian
  description: ''
  trigger:
  - entity_id: person.adrian
    platform: state
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  action:
  - service: mqtt.publish
    data:
      payload_template: '{{ states(''person.adrian'')}}'
      topic: homeassistant/person/adrian
- id: '1582300595341'
  alias: Rollershutter:Dining:Morning:Open
  description: ''
  trigger:
  - event: sunrise
    platform: sun
    offset: 00:45:00
  condition:
    - condition: numeric_state
      entity_id: sensor.ble_temperature_a4c138b45222
      above: 22
    - condition: numeric_state
      entity_id: sensor.darlington_rain_chance_0
      below: 50
  action:
  - entity_id: cover.dining_room_rollershutter
    service: cover.open_cover
  mode: single
- id: '1582300676427'
  alias: Rollershutter:Dining:Afternoon:Open
  description: ''
  trigger:
  - at: '13:00:00'
    platform: time
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  - condition: numeric_state
    entity_id: sensor.ble_temperature_a4c138b45222
    above: '22'
  - condition: numeric_state
    entity_id: sensor.darlington_rain_chance_0
    below: '50'
  - condition: numeric_state
    entity_id: sensor.ble_temperature_a4c138dfcf8d
    below: '24'
  action:
  - entity_id: cover.dining_room_rollershutter
    service: cover.open_cover
  mode: single
# - id: '1584459956003'
#   alias: Switch:Kettle:Started
#   description: ''
#   trigger:
#   - entity_id: switch.switch_arlec_1
#     for: 00:00:15
#     platform: state
#     to: 'on'
#   condition:
#   - condition: state
#     entity_id: binary_sensor.active
#     state: 'on'
#   - condition: state
#     entity_id: sensor.switch_arlec_1_energy_current
#     state: '0.0'
#   action:
#   - service: notify.mobile_app_adrian_s_phone
#     data:
#       message: The kettle has not started.
#       title: Kettle
#   mode: single
# - id: '1584460382480'
#   alias: Switch:Kettle:Finished
#   description: ''
#   trigger:
#   - below: 200
#     entity_id: sensor.switch_kettle_1_energy_voltage
#     platform: numeric_state
#   condition:
#   - condition: state
#     entity_id: binary_sensor.active
#     state: 'on'
#   - condition: device
#     device_id: 24270fe8bcce46d7a35d5929c4f467f0
#     domain: switch
#     entity_id: switch.switch_kettle_1
#     for:
#       hours: 0
#       minutes: 0
#       seconds: 10
#     type: is_on
#   action:
#   - service: notify.mobile_app_adrian_s_phone
#     data:
#       message: The kettle has boiled.
#       title: Kettle
#   - delay: 00:01:00
#   - condition: state
#     entity_id: binary_sensor.switch_kettle_1_button1
#     state: 'on'
#   - service: notify.mobile_app_adrian_s_phone
#     data:
#       message: The kettle has not been reset
#       title: Kettle
#   - device_id: 24270fe8bcce46d7a35d5929c4f467f0
#     domain: switch
#     entity_id: switch.switch_kettle_1
#     type: turn_off
#   mode: single
- id: '1611678447095'
  alias: Rollershutter:Jonathans Bedroom:Open:Time
  description: Open the Jonathans Bedroom Roller shutter at 07:30
  trigger:
  - platform: time
    at: 07:30:00
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  - condition: state
    entity_id: group.family
    state: home
  - condition: time
    weekday:
    - mon
    - tue
    - wed
    - thu
    - fri
    - sat
  - condition: numeric_state
    entity_id: sensor.ble_temperature_a4c138b45222
    above: '20'
  action:
  - service: cover.set_cover_position
    data:
      position: 100
    target:
      entity_id: cover.boys_bedroom_rollershutter
  mode: single
- id: '1611763659185'
  alias: Rollershutter:Master Bedroom:Open:Time
  description: ''
  trigger:
  - platform: time
    at: 07:30:00
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  - condition: state
    entity_id: group.family
    state: home
  - condition: time
    weekday:
    - mon
    - tue
    - wed
    - thu
    - fri
    - sat
  - condition: numeric_state
    entity_id: sensor.ble_temperature_a4c138fbfa2a
    above: '22'
  action:
  - service: cover.open_cover
    data: {}
    entity_id: cover.master_bedroom_rollershutter
  mode: single
- id: '1613410356423'
  alias: Rollershutters:Close:Sunrise
  description: ''
  trigger:
  - platform: sun
    event: sunrise
    offset: -00:45:00
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  action:
  - service: cover.close_cover
    data: {}
    entity_id: cover.master_bedroom_rollershutter, cover.boys_bedroom_rollershutter
  mode: single
- id: '1620144351328'
  alias: Switch:Nancys Electric Blanket
  description: ''
  trigger:
  - platform: state
    entity_id: person.nancy
    to: Home
  - platform: time
    at: '21:01:00'
    id: time
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  - condition: time
    after: '21:01:00'
  - condition: numeric_state
    entity_id: sensor.ble_temperature_a4c138fbfa2a
    below: '21'
  - condition: state
    entity_id: person.nancy
    state: Home
  action:
  - service: switch.turn_on
    target:
      entity_id: switch.nancys_electric_blanket
  - delay:
      hours: 1
      minutes: 0
      seconds: 0
      milliseconds: 0
  - service: switch.turn_off
    target:
      entity_id: switch.nancys_electric_blanket
  mode: restart
- id: '1620211204748'
  alias: Climate:Boys Bedrooms:Warm
  description: ''
  trigger:
  - platform: time
    at: '20:00:00'
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  - condition: state
    entity_id: group.family
    state: home
  - condition: numeric_state
    entity_id: sensor.ble_temperature_a4c138b45222
    below: '20'
  action:
  - service: climate.set_hvac_mode
    data:
      hvac_mode: heat
    target:
      entity_id:
      - climate.davids_thermostat
      - climate.jonathans_thermostat
  mode: single
- id: '1620211304299'
  alias: Turn off Boy's Bedroom Heaters / Fans
  description: ''
  trigger:
  - platform: time
    at: 08:00:00
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  action:
  - service: climate.set_hvac_mode
    data:
      hvac_mode: 'off'
    target:
      entity_id:
      - climate.davids_thermostat
      - climate.jonathans_thermostat
  mode: single
- id: '1620375343556'
  alias: Rollershutter:Dining:Afternoon:Close
  description: ''
  trigger:
  - platform: time
    at: '13:00:00'
  - platform: sun
    event: sunset
    offset: -00:45:00
  condition:
  - condition: numeric_state
    entity_id: sensor.ble_temperature_a4c138b45222
    below: '22'
  - condition: or
    conditions:
    - condition: numeric_state
      entity_id: sensor.darlington_rain_chance_0
      above: '50'
    - condition: numeric_state
      entity_id: sensor.ble_temperature_a4c138dfcf8d
      above: '24'
    - condition: sun
      before: sunset
      before_offset: 00:45:00
  action:
  - service: cover.close_cover
    target:
      entity_id: cover.dining_room_rollershutter
  mode: single
- id: '1620376925668'
  alias: Light:DiningRoom:Off:Rollershutters:Open
  description: ''
  trigger:
  - platform: state
    entity_id: cover.dining_room_rollershutter
    to: open
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  - condition: state
    entity_id: input_boolean.hot_water_system
    state: 'on'
  action:
  - service: light.turn_off
    target:
      entity_id:
      - light.dining_room_lights
      - light.family_room_lights
      - light.music_room_light
    data:
      transition: 30
  mode: single
- id: '1620377026335'
  alias: Light:DiningRoom:On:Rollershutters:Close
  description: ''
  trigger:
  - platform: state
    entity_id: cover.dining_room_rollershutter
    to: closed
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  - condition: state
    entity_id: group.family
    state: home
  action:
  - service: light.turn_on
    data:
      transition: 30
      color_temp: 280
      brightness: 100
  mode: single
- id: '1630777198910'
  alias: Switch:Jonathans Heater:Off
  description: Turn off Jonathan's Heater in the morning
  trigger:
  - platform: time
    at: 08:30
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  action:
  - service: climate.turn_off
    target:
      entity_id: climate.jonathans_thermostat
  mode: single
- id: '1630909236404'
  alias: Lights:Toggle Study Lights:Button
  description: ''
  trigger:
  - platform: event
    event_type: esphome.rf_code_received
    event_data:
      code: '9763476'
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  action:
  - choose:
    - conditions:
      - condition: state
        entity_id: input_select.study_scene
        state: scene.scene_study_bright
      sequence:
      - scene: scene.scene_study_normal
    default:
    - scene: scene.scene_study_bright
  mode: single
- id: '1636125125123'
  alias: Media:Boys-Speakers:Time
  description: Turn off the boy's speakers at midnight
  trigger:
  - platform: time
    at: 00:00
  action:
  - service: media_player.media_stop
    target:
      device_id:
      - fc5fc2c32960cd0c6d56f4ff0122a050
      - 5d1c01a08144d81793bda01ab075cae6
  mode: single
- id: '1654222877842'
  alias: TTS:Water-Heater:Sensor
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.water_heating
    to: 'off'
  condition:
  - condition: time
    before: '15:00:00'
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  action:
  - service: tts.google_translate_say
    data:
      entity_id: media_player.kitchen_speaker, media_player.dining_room_display
      message: The water is hot
  mode: single
- id: '1658155227206'
  alias: Low-Battery-Alarm
  description: ''
  use_blueprint:
    path: sbyx/low-battery-level-detection-notification-for-all-battery-sensors.yaml
    input:
      exclude:
        entity_id:
        - sensor.nokia_5_3_battery_level
        - sensor.david_s_phone_battery_level
        - sensor.jonathan_s_phone_battery_level
        - sensor.nancys_phone_battery_level
      actions:
      - service: notify.mobile_app_adrians_phone
        data:
          title: 'Low Battery '
          message: '{{sensors}}'
- id: '1658506699917'
  alias: Thermostat:Master Bedroom:Time
  description: ''
  trigger:
  - platform: time
    at: '19:30:00'
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  - condition: state
    entity_id: group.family
    state: home
  - condition: numeric_state
    entity_id: sensor.temperature_843c01d60760f228
    below: '19'
  action:
  - service: climate.set_hvac_mode
    data:
      hvac_mode: heat
    target:
      device_id: 28c2ff856d68a09f870340d41b42ea48
  - delay:
      hours: 0
      minutes: 0
      seconds: 30
      milliseconds: 0
  - service: climate.set_temperature
    data:
      temperature: 24
    target:
      device_id: 28c2ff856d68a09f870340d41b42ea48
  - wait_for_trigger:
    - platform: time
      at: '20:30:00'
  - service: climate.set_temperature
    data:
      temperature: 19
    target:
      device_id: 28c2ff856d68a09f870340d41b42ea48
  mode: single
- id: '1660579474503'
  alias: Media:Volume:Volumio
  description: ''
  trigger:
  - platform: state
    entity_id:
    - media_player.yamaha_receiver_media_room
    attribute: source
    to: Volumio
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  - condition: numeric_state
    entity_id: media_player.yamaha_receiver_media_room
    attribute: volume_level
    above: '0.6'
  action:
  - service: media_player.volume_set
    data:
      volume_level: 0.6
    target:
      entity_id: media_player.yamaha_receiver_media_room
  mode: single
- id: '1661337897543'
  alias: Light/Cover:Jonathan:Morning
  description: ''
  use_blueprint:
    path: light-morning.yaml
    input:
      light_id: light.lifx_jonathans_bedroom
      cover_id: cover.jonathans_bedroom_rollershutter
      temperature_sensor_id: sensor.ble_outside_temperature
      person_id: person.jonathan
      schedule_id: schedule.roller_shutter_open
- id: '1661337951517'
  alias: Light/Cover:David:Morning
  description: ''
  use_blueprint:
    path: light-morning.yaml
    input:
      light_id: light.lifx_davids_room
      cover_id: cover.davids_bedroom_rollershutter
      temperature_sensor_id: sensor.ble_outside_temperature
      person_id: person.david
      schedule_id: schedule.roller_shutter_open
- id: '1661338159225'
  alias: Light/Cover:Master Bedroom:Morning
  description: ''
  use_blueprint:
    path: light-morning.yaml
    input:
      light_id: light.light_masterbedroom_1
      cover_id: cover.master_bedroom_rollershutter
      temperature_sensor_id: sensor.ble_outside_temperature
      person_id: person.adrian
      schedule_id: schedule.roller_shutter_open
- id: '1667828983561'
  alias: Switch:Media&TV:Yamaha
  description: Turn on the Media Centre power switch and TV if the Yamaha is switch
    to Chromecast or Blu-Ray
  trigger:
  - platform: state
    entity_id:
    - media_player.yamaha_receiver_media_room
    attribute: source
    to: ChromeCast
  - platform: state
    entity_id:
    - media_player.yamaha_receiver_media_room
    attribute: source
    to: Blu-Ray
  - platform: state
    entity_id:
    - media_player.yamaha_receiver_media_room
    attribute: source
    to: XBox
  - platform: state
    entity_id:
    - media_player.yamaha_receiver_media_room
    attribute: source
    to: Kodi
    id: Ruby
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  action:
  - if:
    - condition: state
      entity_id: switch.media_centre
      state: 'off'
    then:
    - service: switch.turn_on
      data: {}
      target:
        entity_id: switch.media_centre
    - delay:
        hours: 0
        minutes: 0
        seconds: 5
        milliseconds: 0
  - if:
    - condition: trigger
      id: Ruby
    - condition: state
      entity_id: media_player.ruby
      state: 'off'
    then:
    - service: media_player.turn_on
      data: {}
      target:
        entity_id: media_player.ruby
  - if:
    - condition: state
      entity_id: switch.tv
      state: 'off'
    then:
    - service: switch.turn_on
      data: {}
      target:
        entity_id: switch.tv
  mode: single
- id: '1671383260632'
  alias: Masterbedroom-Rollershutter:Close:Sunrise
  description: ''
  use_blueprint:
    path: rollershutter-sunrise.yaml
    input:
      cover_id: cover.master_bedroom_rollershutter_2
- id: '1671383308349'
  alias: Davids-Rollershutter:Close:Sunrise
  description: ''
  use_blueprint:
    path: rollershutter-sunrise.yaml
    input:
      cover_id: cover.davids_bedroom_rollershutter
- id: '1671383334492'
  alias: Jonathans-Rollershutter:Close:Sunrise
  description: ''
  use_blueprint:
    path: rollershutter-sunrise.yaml
    input:
      cover_id: cover.jonathans_bedroom_rollershutter
- id: '1671782593308'
  alias: Dinningroom-Display:Pause:Lias
  description: ''
  trigger:
  - platform: state
    entity_id:
    - media_player.lias
    from: idle
  condition:
  - condition: state
    entity_id: switch.active
    state: 'True'
  action:
  - service: media_player.media_pause
    data: {}
    target:
      device_id: 8f3ebf674da343f89b4d135432bf52f0
  mode: single
- id: '1673271059602'
  alias: Oven:TTS:At Temperature
  description: ''
  trigger:
  - platform: numeric_state
    entity_id: sensor.red_phase_derivative
    below: -7
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  action:
  - service: tts.google_translate_say
    data:
      entity_id: media_player.kitchen_speaker
      message: The oven is warm.
  - wait_for_trigger:
    - platform: numeric_state
      entity_id: sensor.red_phase_derivative
      for:
        hours: 1
        minutes: 0
        seconds: 0
      above: -1
      below: 1
    continue_on_timeout: false
  mode: single
- id: '1675437422682'
  alias: Cover:Midnight:Close to 20%
  description: Close the bedroom roller shutters to 20% at Midnight if they're still
    open
  trigger:
  - platform: time
    at: '23:30:00'
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  action:
  - if:
    - condition: numeric_state
      entity_id: cover.master_bedroom_rollershutter
      attribute: current_position
      above: 20
    then:
    - service: cover.set_cover_position
      data:
        position: 20
      target:
        device_id: bb0e513dc9863cc93d9d2adf84bdeac7
  - if:
    - condition: numeric_state
      entity_id: cover.davids_bedroom_rollershutter
      attribute: current_position
      above: 20
    then:
    - service: cover.set_cover_position
      data:
        position: 17
      target:
        device_id: 2d5c4db90acaec27809fc493544258ab
  - if:
    - condition: numeric_state
      entity_id: cover.jonathans_bedroom_rollershutter
      attribute: current_position
      above: 20
    then:
    - service: cover.set_cover_position
      data:
        position: 17
      target:
        device_id: feea1151d882acf2ed0fe9ecf078df26
  mode: single
- id: '1678691891721'
  alias: Tag:Alarm:Toggle
  description: ''
  trigger:
  - platform: tag
    tag_id: 0d3364de-a42f-4412-9fa0-d34111f39b77
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  action:
  - choose:
    - conditions:
      - condition: state
        entity_id: alarm_control_panel.mqtt_alarm
        state: disarmed
      sequence:
      - service: alarm_control_panel.alarm_arm_away
        data: {}
        target:
          entity_id: alarm_control_panel.mqtt_alarm
    default:
    - service: alarm_control_panel.alarm_disarm
      data: {}
      target:
        entity_id: alarm_control_panel.mqtt_alarm
  mode: single
- id: '1679062442122'
  alias: Tag:DSOTM
  description: Play DSOTM on Lias
  trigger:
  - platform: tag
    tag_id: 6a935bdb-d2b8-430a-adb3-a7821332dafd
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  action:
  - service: media_player.select_source
    data:
      source: DSOTM
    target:
      entity_id: media_player.lias
  mode: single
- id: '1683198098958'
  alias: Person:Untracked:Start
  description: Set the status of untracked person entities on startup.
  trigger:
  - platform: homeassistant
    event: start
  condition: []
  action:
  - service: device_tracker.see
    data:
      dev_id: guest
      location_name: not_home
  - service: device_tracker.see
    data:
      dev_id: david
      location_name: home
  - service: device_tracker.see
    data:
      dev_id: jonathan
      location_name: home
  mode: single
- id: '1683306290032'
  alias: HASS:Heartbeat:Webhook
  description: Receive the heartbeat via a webhook
  trigger:
  - platform: webhook
    allowed_methods:
    - GET
    local_only: true
    webhook_id: -RoEmpFdS7BtbJW7hijD-IM2z
  - platform: homeassistant
    event: start
  condition: []
  action:
  - service: input_boolean.turn_off
    data: {}
    target:
      entity_id: input_boolean.active
  - delay:
      hours: 0
      minutes: 1
      seconds: 5
      milliseconds: 0
  - service: input_boolean.turn_on
    data: {}
    target:
      entity_id: input_boolean.active
  mode: restart
- id: '1683307199507'
  alias: HASS:Heartbeat:Timer
  description: Pat the standby instance watchdog
  trigger:
  - platform: time_pattern
    seconds: '0'
  - platform: state
    entity_id:
    - input_boolean.active
    to: 'on'
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  action:
  - service: rest_command.heartbeat
    data: {}
  mode: single
- id: '1683545992974'
  alias: Tag:Abbey Road
  description: Play Abbey Road on Lias
  trigger:
  - platform: tag
    tag_id: a871e45a-c4fe-48f5-9453-01fad12372e0
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  action:
  - service: media_player.select_source
    data:
      source: Abbey Road
    target:
      entity_id: media_player.lias
  mode: single
- id: '1683555439210'
  alias: Tag:Bin:Toggle
  description: Toggle the Bin input_boolean when the tag is scanned
  trigger:
  - platform: tag
    tag_id: aa214b1c-41b7-4911-8c90-d20aa861fdb3
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  action:
  - service: input_boolean.toggle
    data: {}
    target:
      entity_id: input_boolean.bin_out
  mode: single
- id: '1683555482794'
  alias: Tag:Recycling:Toggle
  description: Toggle the Recycling input_boolean when the tag is scanned
  trigger:
  - platform: tag
    tag_id: ae1dd00b-0ab3-43c6-9b83-ab6f07eaee3d
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  action:
  - service: input_boolean.toggle
    data: {}
    target:
      entity_id:
      - input_boolean.recycling_out
  mode: single
- id: '1683770514419'
  alias: Switch:Water Heater:Off
  description: Turn off the water heater after a single cycle
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.water_heater
    from: 'on'
    to: 'off'
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  action:
  - service: switch.turn_off
    data: {}
    target:
      entity_id: switch.water_heater
  mode: single
- id: '1684240631072'
  alias: Light:Davids Bedroom Off:Light-on
  description: Turn off the light in David's Bedroom after 30 minutes
  trigger:
  - platform: state
    entity_id:
    - light.lifx_davids_room
    to: 'on'
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  action:
  - delay:
      hours: 0
      minutes: 30
      seconds: 0
      milliseconds: 0
  - service: light.turn_off
    data: {}
    target:
      entity_id: light.lifx_davids_room
  mode: restart
- id: '1684290109250'
  alias: Light:Jonathans Bedroom Off:Light-on
  description: Turn off the light in Jonathan's Bedroom after 30 minutes
  trigger:
  - platform: state
    entity_id:
    - light.lifx_jonathans_bedroom
    to: 'on'
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  action:
  - delay:
      hours: 0
      minutes: 30
      seconds: 0
      milliseconds: 0
  - service: light.turn_off
    data: {}
    target:
      entity_id: light.lifx_jonathans_bedroom
  mode: restart
- id: '1685368433499'
  alias: TTS:Laundry Door:Open
  description: Send announcement if laundry door is left open for 5 minutes.
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.laundry_garage_door
    to: 'on'
    for:
      hours: 0
      minutes: 5
      seconds: 0
  condition:
  - condition: numeric_state
    entity_id: sensor.indoor_temperature_average
    below: 22
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  action:
  - service: tts.google_translate_say
    data:
      cache: false
      entity_id: media_player.dining_room_display
      message: The laundry door is open.
  mode: single
- id: '1688588261987'
  alias: Switch:Media Centre On:IR
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.panasonic_tv_power
    - binary_sensor.panasonic_tv_aux_power
    - binary_sensor.yamaha_aux_power
    to: 'on'
    id: Chromecast
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  action:
  - condition: state
    entity_id: switch.media_centre
    state: 'off'
  - entity_id: switch.media_centre
    service: switch.turn_on
  - service: media_player.turn_on
    data: {}
    target:
      entity_id: media_player.yamaha_receiver_media_room
  - delay:
      hours: 0
      minutes: 0
      seconds: 5
      milliseconds: 0
  - if:
    - condition: trigger
      id: Chromecast
    then:
    - service: media_player.select_source
      data:
        source: ChromeCast
      target:
        entity_id: media_player.yamaha_receiver_media_room
    else:
    - service: media_player.select_source
      data:
        source: Kodi
      target:
        entity_id: media_player.yamaha_receiver_media_room
  mode: single
- id: '1691945017554'
  alias: 'Kettle:Turn On: Nancy''s Phone Unplugged '
  description: 'Turn on the kettle when Nancy unplugs her phone in the morning '
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.nancys_phone_is_charging
    from: 'on'
    to: 'off'
  condition:
  - condition: state
    entity_id: binary_sensor.active
    state: 'on'
  - condition: time
    after: 04:30:00
    before: 09:30:00
  action:
  - wait_for_trigger:
    - platform: event
      event_type: esphome.rf_code_received
      event_data:
        code: '8334156'
    - platform: event
      event_type: esphome.rf_code_received
      event_data:
        code: '14330700'
    - platform: state
      entity_id:
      - binary_sensor.family_room
      - binary_sensor.media_room
      to: 'on'
  - service: switch.turn_on
    data: {}
    target:
      entity_id: switch.kettle
  mode: single
- id: '1698205614482'
  alias: Switch:Network:Voltage-Low
  description: Switch on the Network power supply when the battery voltage drops below
    12.5V
  trigger:
  - platform: numeric_state
    entity_id: sensor.sensor_study_1_adc
    for:
      hours: 0
      minutes: 1
      seconds: 0
    below: 12.1
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  - condition: state
    entity_id: switch.network
    state: 'off'
  action:
  - service: switch.turn_on
    data: {}
    target:
      entity_id: switch.network
  mode: single
- id: '1698205702578'
  alias: Switch:Network:Voltage-High
  description: Switch off the Network power supply when the battery voltage rises
    above 12.7V
  trigger:
  - platform: numeric_state
    entity_id: sensor.sensor_study_1_adc
    for:
      hours: 0
      minutes: 1
      seconds: 0
    above: 12.8
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  - condition: state
    entity_id: switch.network
    state: 'on'
  action:
  - service: switch.turn_off
    data: {}
    target:
      entity_id: switch.network
  mode: single
- id: '1698648866024'
  alias: Switch:Davids Computer:Screentime
  description: Turn off David's Computer at the end of screentime
  trigger:
  - platform: state
    entity_id:
    - switch.davids_computer
    to: 'on'
    for: '{{ as_timedelta(''PT'' + states(''counter.davids_screen_time'') + ''M'')
      + as_timedelta(''00:05:00'') }}'
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  action:
  - variables:
      action_shutdown: '{{ ''SHUTDOWN_'' ~ context.id }}'
  - service: notify.parents
    data:
      message: David's screentime is up.
      data:
        channel: David's Computer
        importance: high
        visibility: public
        notification_icon: mdi:desktop-classic
        actions:
        - action: ' {{ action_shutdown }}'
          title: Turn off now
  - wait_for_trigger:
    - platform: event
      event_type: mobile_app_notification_action
      event_data:
        action: '{{ action_shutdown }}'
  - service: switch.turn_off
    data: {}
    target:
      entity_id: switch.davids_computer
  mode: restart
- id: '1698678437802'
  alias: Switch:Jonathans Computer:Screen Time
  description: Turn off Jonathan's Computer at the end of screentime
  trigger:
  - platform: state
    entity_id:
    - switch.jonathans_computer
    to: 'on'
    for: '{{ as_timedelta(''PT'' + states(''counter.jonathans_screen_time'') + ''M'')
      + as_timedelta(''00:05:00'') }}'
  condition:
  - condition: state
    entity_id: input_boolean.active
    state: 'on'
  action:
  - variables:
      action_shutdown: '{{ ''SHUTDOWN_'' ~ context.id }}'
  - service: notify.parents
    data:
      message: Jonathan's screentime is up.
      data:
        channel: Jonathan's Computer
        importance: high
        visibility: public
        notification_icon: mdi:desktop-classic
        actions:
        - action: ' {{ action_shutdown }}'
          title: Turn off now
  - wait_for_trigger:
    - platform: event
      event_type: mobile_app_notification_action
      event_data:
        action: '{{ action_shutdown }}'
  - service: switch.turn_off
    data: {}
    target:
      entity_id: switch.jonathans_computer
  mode: restart
- id: '1698678587465'
  alias: Time:Screentime:Reset
  description: Reset the screentime for the day at midnight
  trigger:
  - platform: time
    at: 00:01:00
  condition: []
  action:
  - choose:
    - conditions:
      - condition: time
        weekday:
        - sat
        - sun
      sequence:
      - service: counter.set_value
        data:
          value: 120
        target:
          entity_id:
          - counter.davids_screen_time
          - counter.jonathan_s_screen_time
    default:
    - service: counter.reset
      data: {}
      target:
        entity_id:
        - counter.davids_screen_time
        - counter.jonathan_s_screen_time
  mode: single
